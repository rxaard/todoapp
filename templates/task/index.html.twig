{% extends 'base.html.twig' %}

{% block title %}Liste de Tâches{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.23/css/jquery.dataTables.min.css">
{% endblock %}

{% block body %}
    <div class="container mt-5">
    <a href="{{ path('task_create') }}" class= "btn btn-primary mb-2">{{"button.add"|trans}}</a>
        <table class="table table-striped table-bordered" id="tasksTable">
            <thead>
                <th>Id</th>
                <th>Nom</th>
                <th>Date effective</th>
                <th>Catégorie</th>
                <th>UpDate</th>
                <th>Delete</th>
            </thead>
            <tbody>
            {% if tasks is defined %}
                {% for task in tasks%}
                <tr>
                    <th scope="row">{{task.id}}</th>
                    <td class="clickable" data-id="{{path('task_detail', {'id':task.id})}}">{{task.name}}</td>
                    <td>{{task.dueAt | date('date'|trans)}}</td>
                    <td>{{task.tag.name}}</td>
                    <td>
                        <a href="{{path('task_update', {'id':task.id})}}" class ="btn btn-success">Update</a>
                    </td>
                     <td>
                        <a href="{{path('task_delete', {'id':task.id})}}" class ="btn btn-danger">Delete</a>
                    </td>
                </tr>
                {% endfor %}
            {% endif %}
            </tbody>
        </table>

    </div>

{% endblock %}

{% block javascripts %}
   <script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"> </script>
   <script>
		if(window.location.href.includes('fr')){
			$(document).ready(function () {
				$('#tasksTable').DataTable( {
			"language": {
				"url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/French.json"
				}
    		});
		});
		} else {
					$(document).ready(function () {
            $('#tasksTable').DataTable( {
        "language": {
            "url": "//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/English.json"
				}
			});
		});
		}
	</script>
    <script>
            $(".clickable").click(function(e) {
        $valeur= e.currentTarget.getAttribute("data-id");
        document.location=$valeur;
        return $valeur; 
        });
    </script>
{% endblock %}
